<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
  "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Mutation</title>
    
    <link rel="stylesheet" href="_static/epub.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" /> 
  </head>
  <body role="document">

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="__slots__magic.html" title="__slots__ Magic"
             accesskey="N">next</a></li>
        <li class="right" >
          <a href="global_&_return.html" title="Global &amp; Return"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Python Tips 0.1 documentation</a> &raquo;</li> 
      </ul>
    </div>

    <div class="document">
      <div class="documentwrapper">
          <div class="body" role="main">
            
  <div class="section" id="mutation">
<h1>Mutation</h1>
<p>The mutable and immutable datatypes in Python cause a lot of headache
for new programmers. In simple words, mutable means &#8216;able to be changed&#8217;
and immutable means &#8216;constant&#8217;. Want your head to spin? Consider this
example:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">foo</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;hi&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="c"># Output: [&#39;hi&#39;]</span>

<span class="n">bar</span> <span class="o">=</span> <span class="n">foo</span>
<span class="n">bar</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;bye&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="c"># Output: [&#39;hi&#39;, &#39;bye&#39;]</span>
</pre></div>
</div>
<p>What just happened? We were not expecting that! We were expecting
something like this:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">foo</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;hi&#39;</span><span class="p">]</span>
<span class="k">print</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="c"># Output: [&#39;hi&#39;]</span>

<span class="n">bar</span> <span class="o">=</span> <span class="n">foo</span>
<span class="n">bar</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;bye&#39;</span><span class="p">]</span>

<span class="k">print</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
<span class="c"># Output: [&#39;hi&#39;]</span>

<span class="k">print</span><span class="p">(</span><span class="n">bar</span><span class="p">)</span>
<span class="c"># Output: [&#39;hi&#39;, &#39;bye&#39;]</span>
</pre></div>
</div>
<p>It&#8217;s not a bug. It&#8217;s mutability in action. Whenever you assign a
variable to another variable of mutable datatype, any changes to the
data are reflected by both variables. The new variable is just an alias
for the old variable. This is only true for mutable datatypes. Here is a
gotcha involving functions and mutable data types:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">add_to</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">target</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">target</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Output: [1]</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c"># Output: [1, 2]</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c"># Output: [1, 2, 3]</span>
</pre></div>
</div>
<p>You might have expected it to behave differently. You might be expecting
that a fresh list would be created when you call <code class="docutils literal"><span class="pre">add_to</span></code> like this:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">add_to</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="p">[]):</span>
    <span class="n">target</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">target</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c"># Output: [1]</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c"># Output: [2]</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="c"># Output: [3]</span>
</pre></div>
</div>
<p>Well again it is the mutability of lists which causes this pain. In
Python the default arguments are evaluated once when the function is
defined, not each time the function is called. You should never define
default arguments of mutable type unless you know what you are doing.
You should do something like this:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">add_to</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">target</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">target</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="n">target</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">target</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">target</span>
</pre></div>
</div>
<p>Now whenever you call the function without the <code class="docutils literal"><span class="pre">target</span></code> argument, a
new list is created. For instance:</p>
<div class="code python highlight-python"><div class="highlight"><pre><span class="n">add_to</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c"># Output: [42]</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c"># Output: [42]</span>

<span class="n">add_to</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c"># Output: [42]</span>
</pre></div>
</div>
</div>


          </div>
      </div>
      <div class="clearer"></div>
    </div>

    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Muhammad Yasoob Ullah Khalid.
    </div>
  </body>
</html>